{% extends 'singles/single.twig' %}

{% block before_content %}
	<header class="header header-lesson header-single">

		<div class="contain--sm">
			
			{# <form action="" method="post">
				{% set field = '_lesson_' ~ post.id ~ '_complete' %}
				
				{% if lesson_completed == 'false' %}
					<h4>Have you completed this lesson?</h4>
					<label for="1{{field}}">Mark Complete</label>
					<input id="1{{field}}" type="radio" value="true" name="{{field}}">
				{% else %}
					<h4>You completed this lesson!</h4>
					<label for="2{{field}}">Mark Incomplete</label>
					<input id="2{{field}}" type="radio" value="false" name="{{field}}">
				{% endif %}

				<input type="submit" name="submit" value="Go">
			</form> #}
			{# 
			<ul class="nav"> #}
				{% for t in post.terms('class') %}
					<p class="meta">{{t.name}}</p>
				{% endfor %}
			{# </ul> #}

			{% if post.header_display == 'image' %}
				{# TODO: Image will be included here. #}
			{% elseif post.header_display == 'svg' %}
				{% include 'partials/svg.twig' with { file : post.header_svg, prefix : 'shape' } %}
			{% endif %}	
			
			{% for l in related_lessons %}
				{% if l.title == post.title %}<p class="helper-support">Lesson {{loop.index}}</p>{% endif %}
			{% endfor %}

			{% if post.lesson_date_time %}
				<time>{{post.lesson_date_time|date('F j, g:ia')}}</time>
			{% endif %}

			<h1 class="title-single--lesson">{{post.post_title}}</h1>
			
		</div>
		<div class="contain--sm">
			<p class="lead lead-header">{{post.header_tagline}}</p>
			{{post.header_summary|wpautop}}
		</div>

	</header>
{% endblock %}

{% block content %}
{# 
	<div class="contain--sm">
		<aside class="cell cell--sixth" role="complementary">
			<h4>Lesson Links</h4>
			<ul class="list list--minor"> #}
			{# {% for link in post.lesson_links %} 
				<li><a href="{{post.download_link}}">Download video</a></li>
				<li><a href="{{post.download_link}}">View transcript</a></li>
			 {% endfor %} #}
		{# 	</ul>
		</aside>
		<div class="cell">
			<div class="media-enhanced">
				{{post.video}}
			</div>
		</div>
	</div> #}

 	<div class="contain--sm">
		{% if post.event_page %}<a class="btn btn--cta" target="blank" href="{{post.event_page}}">Hangout Page</a>{% endif %}
		{% if post.download_link %}<a class="btn btn--cta" target="blank" href="{{post.download_link}}">Download Video</a>{% endif %}
		{% if post.slides_link %}<a class="btn btn--cta" target="blank" href="{{post.slides_link}}">Slides</a>{% endif %}
	</div>
  
	<div class="contain--md">
		<div class="media-enhanced">
			{{post.video}}
		</div>
	</div>
 	

 	{% if post.lesson_segments %}
	 	<section class="contain--sm" id="lesson-breakdown">
	 		<h3 class="section__title">Lesson Breakdown</h3>
			<ol class="list--minor">
				{% for item in post.get_field('lesson_segments') %}
					<li>
						<h4>{{item.title}} <span class="meta--med">{{item.time_in_video}}</span></h4>
						{{item.description}}
					</li>
				{% endfor %}
			</ol>
		</section>
	{% endif %}
 
	{# Blocks for additional Lesson content #}
	
	{% for block in post.get_field('blocks') %} 
		{% include 'blocks/block-logic.twig' %}
	{% endfor %}
	
	{% if post.learning_goals %}
		<section class="contain--sm" id="learning-goals">
			<h3 class="section__title">Learning Goals</h3>
			{{post.learning_goals|wpautop}}
		</section> <!-- /#learning-goals -->
	{% endif %}

	<section class="contain--sm" id="assignments">

		{% if post.assigments %}
			<h3 class="section__title">Assignments</h3>
			{{post.assignments_summary|wpautop}}
			
			{% for block in post.get_field('assignment_blocks') %}
				{% include 'blocks/block-logic.twig' %}
			{% endfor %}
			
			<ul class="block_list-list">
			{% for item in post.get_field('assignments') %}
				<li>
					<h4>{{item.item_title}}</h4>
					{{item.item_description|wpautop}}
				</li>
			{% endfor %}
			</ul>
		{% endif %}
	
		{% if post.tutorials %}
			<h4>Tutorials</h3>
			{{post.tutorials_summary|wpautop}}
			<div class="list--major bleed">
				{% for post in post.get_field('tutorials') %}
					{% set post = TimberPost(post) %}
					{% include 'teases/_tease-source.twig' %}
				{% endfor %}		
			</div>
		{% endif %}

		{% if post.readings %}
			<h4>Resources</h4>
			{{post.readings_summary|wpautop}}
			<ul class="list--minor">
				{% for post in post.readings %}
					{% set post = TimberPost(post) %}
					{% include 'teases/_tease-source.twig' %}
				{% endfor %}
			</ul>
		{% endif %}

	</section> <!-- /#assignments -->

{% endblock %}

{% block after_content %}
	<div class="contain--md">
		{% include 'partials/prevnext.twig' %}
	</div>	
	<div class="contain--sm">
	<h5>Other lessons in this series:</h5>	
		<ol>
			{% for l in related_lessons %}
				<li><a href="{{l.link}}">{{l.title}}</a></li>
			{% endfor %}
		</ol>
	</div>
{% endblock %}