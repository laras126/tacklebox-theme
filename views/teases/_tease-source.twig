{% extends 'teases/tease.twig' %}

{% block content %}
	<div class="tease__meta">
		{% for type in post.terms('source_type') %}
			{{type.name}}{{ loop.last ? '' : ', ' }}
		{% endfor %}
		|
		{% if post.terms('category') %}
			{% for type in post.terms('category') %}
				{{type.name}}{{ loop.last ? '' : ', ' }}
			{% endfor %}
		{% endif %}
	</div>

	<div class="tease__content">

		<h5 class="tease__content__title--source">
			{% include 'partials/svg.twig' with { file: 'link', prefix: 'icon' } %}
			<a href="{{post.source_url}}" target="blank">{{post.post_title}}</a>
		</h5>

		{# TODO: Can this be cleaned up? #}
		{% if post.source_author or post.source_publication %}
			<p class="tease__content__meta--source">
			{% if post.source_author %}
				{{post.source_author_link ? 'By <a href="' ~ post.source_author_link ~ '" target="blank">'}}
					{{post.source_author}}
				{{post.source_author_link ? '</a>'}}
			{% endif %}

			{% if post.source_publication %}
				{{post.source_author ? ' | ' }}
				{{post.source_publication_link ? '<a href="' ~ post.source_publication_link ~ '" target="blank">'}}
				{{post.source_publication}}
				{{post.source_publication_link ? '</a>'}}
			{% endif %}
			</p>
		{% endif %}
		

		{{post.source_blurb ? '<p class="tease__blurb--source">' ~ post.source_blurb ~ '</p>'}}
		

		{{function('edit_post_link', 'Edit', '<span class="edit-link">', '</span>', post.ID)}}
	</div>

	{% for t in post.terms('category')|slice(0,1) %}
		{% set name = t.name|lower|replace({' ': '-'}) %}
		{% for type in post.terms('source_type') %}
			{% include 'partials/svg.twig' with { file: name, prefix: 'shape' } %}
		{% endfor %}
	{% endfor %}

{% endblock %}